!function(){var e=function(){function e(){f(),alert("Task added successfully","Task added"),document.forms.add.desc.value="",document.forms.add.due_date.value="",location.hash="#list"}var t=function(){setTimeout(function(){window.scrollTo(0,0)},1e3)},n=function(){switch(location.hash){case"#add":document.body.className="add";break;case"#settings":document.body.className="settings";break;default:document.body.className="list"}t()};n(),window.addEventListener("hashchange",n,!1),window.addEventListener("orientationchange",t,!1);var a="localStorage"in window,s=function(){if(a){var e=localStorage.getItem("name"),t=localStorage.getItem("colorScheme"),n=document.getElementById("user_name"),s=document.forms.settings.name,o=document.documentElement,d=document.forms.settings.color_scheme;e?(n.innerHTML=e+"'s",s.value=e):(n.innerHTML="My",s.value=""),t?(o.className=t.toLowerCase(),d.value=t):(o.className="blue",d.value="Blue")}},o=function(e){if(e.preventDefault(),a){var t=document.forms.settings.name.value;if(t.length>0){var n=document.forms.settings.color_scheme.value;localStorage.setItem("name",t),localStorage.setItem("colorScheme",n),s(),alert("settings saved successfully","settings saved"),location.hash="#list"}else alert("Please Enter Your Name")}else alert("You Brower is not support localStorage")},d=function(e){e.preventDefault(),confirm("This Will erase all data. Are you sure?","Reset data")&&(a&&localStorage.clear(),s(),alert("Application data has been reset","Reset successful"),location.hash="#list")};s(),document.forms.settings.addEventListener("submit",o,!1),document.forms.settings.addEventListener("reset",d,!1);var c,i=window.indexedDB||window.webkitIndexedDB||window.mozIndexedDB||window.msIndexedDB||!1,r=window.IDBKeyRange||window.webkitIDBKeyRange||window.mozIDBKeyRange||window.msIDBKeyRange||!1,l="openDatabase"in window,u=function(){if(i){var e=i.open("tasks",1),t="onupgradeneeded"in e;e.onsuccess=function(e){if(c=e.target.result,t||"1"==c.version)f();else{var n=c.setVersion("1");n.onsuccess=function(e){var t=c.createObjectStore("tasks",{Keypath:"id"});t.createIndex("desc","descUpper",{unique:!1}),f()}}},t&&(e.onupgradeneeded=function(e){c=e.target.result;var t=c.createObjectStore("tasks",{Keypath:"id"});t.createIndex("desc","descUpper",{unique:!1})})}else l&&(c=openDatabase("tasks","1.0","Tasks database",5242880),c=transaction(function(e){var t="CREATE TABLE IF NOT EXISTS tasks(id INTEGER PRIMARY KEY ASC,desc TEXT,due DATATIMEcomplete BOOLEAN)";e.executeSql(t,[],f)}))};u();var m=function(e,t){var n=document.createElement("li");e.length>0?n.innerHTML='<div class = "item_title">No tasks match your query <strong>'+e+"</strong></div>":n.innerHTML='<div class = "item_title">No tasks to display.<a href="#add">Add one</a>?</div>',t.appendChild(n)},v=function(e,t){var n=document.createElement("li"),a=1==e.complete?'checked ="checked"':"";n.innerHTML='<div class="item_complete"><input type="checkbox" name="item_complete"id = "chk_'+e.id+' " '+a+'></div><div class = "item_delete"><a href+"#" id = "del_'+e.id+'">Delete</a></div><div class = "item_title">'+e.desc+'</div><div class = "item_due">'+e.due+"<div>",t.appendChild(n);var s=function(t){t.preventDefault();var n={id:e.id,desc:e.desc,descUpper:e.desc.toUpperCase(),due:e.due,complete:t.traget.checked};updateTask(n)},o=function(t){t.preventDefault(),confirm("Deleting task. Are you sure?","Delete")&&h(e.id)};document.getElementById("chk_"+e.id).onchange=s,document.getElementById("del_"+e.id).onclick=o},f=function(e){var t=document.getElementById("task_list"),n=e||"";if(t.innerHTML="",i){var a,s=c.transaction(["tasks"],"readonly"),o=s.objectStore("tasks"),d=0;if(n.length>0){var l=o.index("desc"),u=n.toUpperCase(),f=r.bound(u,u+"z");a=l.openCursor(f)}else a=o.openCursor();a.onsuccess=function(e){var n=e.target.result;null!==n&&(d++,v(n.value,t),n["continue"]())},s.concomplete=function(e){0===d&&m(n,t)}}else alert("your brower is not support IndexedDB")},p=function(e){e.preventDefault();var t=document.forms.search.query.value;t.length>0?f(t):f()};document.forms.search.addEventListener("submit",p,!1);var g=function(t){t.preventDefault();var n=document.forms.add.desc.value,a=document.forms.add.due_date.value;if(n.length>0&&a.length>0){var s={id:(new Date).getTime(),desc:n,descUpper:n.toUpperCase,due:a,complete:!1};if(i){var o=c.transaction(["task"],"readwrite"),d=o.objectStore("tasks");d.add(s);o.concomplete=e}else alert("insertTasks not support")}else alert("please fill out all fields","Add task error")};document.forms.add.addEventListener("submit",g,!1);var h=function(e){var t=c.transaction(["tasks"],"readwrite"),n=t.objectStore("tasks");n["delete"](e);t.concomplete=f}};window.addEventListener("load",function(){new e},!1)}();